{% extends 'rate_my_walk/base.html' %}
{% load staticfiles %}

{% block title_block %}
    {{ walk.name }}
{% endblock %}

{% block body_block %}

<script src="https://unpkg.com/feather-icons"></script>

<div class = "jumbotron p-4">
        <div class="container">
            <h1 class="jumbotron-heading">{{ walk.name }}</h1>
        </div>
</div>

<main class="container">
  <div class="row">
    <div class="col-md-6">

      <article class="blog-post">
        <h3>Description</h3>
        <p>{{ walk.desc }}</p>
        <br />
        <ul class="list-unstyled">
          <li><span data-feather="play"></span>Start walk on {{ walk.start }}</li>
          <li><span data-feather="stop-circle"></span>End walk on {{ walk.end }}</li>
        </ul>

      </article><!-- /.blog-post end of desc -->

      <article class="blog-post">
        <h3> Uploader(<a href="{%url 'rate_my_walk:profile' username=walk.owner %}">{{walk.owner}}'s</a>) Rating</h3>
        <div class="row">

            <div class="row-md-6">
            <ul class="list-unstyled">
                <li><span data-feather="star"></span>Difficulty: </li>
                <li><span data-feather="star"></span>Duration: </li>
                <li><span data-feather="star"></span>How Enjoyable: </li>
            </ul>
            </div>
            
            <div class="row-md-2">
            <ul class="list-unstyled">
                <li class="alignedRating">{{ walk.difficulty }}</li>
                <li class="alignedRating">{{ walk.duration }}</li>
                <li class="alignedRating">{{ walk.enjoyment }}</li>
            </ul>
            </div>
        </div>
        
      </article><!-- /.blog-post -->
        
      <article class="blog-post">
          
        <h3>This many people like {{ walk.name }}</h3>
          <div>
            <strong id="like_count">{{ walk.likes }}</strong> likes
            {% if user.is_authenticated %}
            <button id="like_btn"
            		data-walk_id="{{ walk.id }}"
            		class="btn bg-dark text-white btn-sm"
            		type="button">
                <span data-feather="thumbs-up"></span>
                Like Walk
            </button>
              <br />
            Like if you also enjoyed this walk!
            {% endif %}
          </div>
    </article>
        
        
    <article class="blog-post">
        <h3>User Ratings</h3>
        <div class="row">
			{% if difficulty %}
				<div class="row-md-6">
				<ul class="list-unstyled">
					<li><span data-feather="star"></span>Difficulty: </li>
					<li><span data-feather="star"></span>Duration: </li>
					<li><span data-feather="star"></span>How Enjoyable: </li>
				</ul>
				</div>
				
				<div class="row-md-2">
				<ul class="list-unstyled">
					<li class="alignedRating">{{ difficulty }}</li>
					<li class="alignedRating">{{ duration }}</li>
					<li class="alignedRating">{{ enjoyment }}</li>
				</ul>
				</div>
			{% else %}
				<span data-feather="star"></span>No one rated this walk yet.
			{% endif %}
        </div>
        
      </article><!-- /.blog-post -->

    </div>

    <div class="col-md-6">
        <div>
            <img id="walkImage" src="{{walk.cover.url}}" alt="{{ walk.name }}" />
        </div>
        <br />
        
        <div class="col-md-10">
        <div class="py-1 mb-2 bg-dark rounded">
            <nav class="nav d-flex justify-content-center">
                <a class="p-2 link-secondary" href="{% url 'rate_my_walk:more_images' walk.slug %}"><p class="navbarText">More Images</p></a>
            </nav>
        </div>    

        <div class="py-1 mb-2 bg-dark rounded">
            <nav class="nav d-flex justify-content-center">
            {% if user.is_authenticated %}
                <a class="p-2 link-secondary" href="{% url 'rate_my_walk:rateWalk' walk.slug %}"><p class="navbarText">Rate Walk Yourself</p></a>
            {% else %}
                 <a class="p-2 link-secondary" id="unauthenticated-user-rating">
                    <p class="navbarText">Rate Walk Yourself</p>
                </a>
            {% endif %}
            </nav>
        </div>
        		
        {% if user.is_authenticated and user == walk.owner %}
        <div class="py-1 mb-2 bg-dark rounded">
            <nav class="nav d-flex justify-content-center">
                <a class="p-2 link-secondary" href="{% url 'rate_my_walk:edit_walk' walk.slug %}"><p class="navbarText">Edit Walk</p></a>
			</nav>
		</div>
		
		<div class="py-1 mb-2 bg-dark rounded">
            <nav class="nav d-flex justify-content-center">
				<form id="delete" method="post" action="{% url 'rate_my_walk:showWalk' walk.slug %}", enctype="multipart/form-data">
					{% csrf_token %}
					{% for hidden in delete_form.hidden_fields %}
						{{ hidden }}
					{% endfor %}
					{% for field in delete_form.visible_fields %}
						{{ field.errors }}
						{{ field.help_text }}
						{{ field }}
					{% endfor %}
					<button class="btn" type="submit" name="submit" id="delete-walk">
						<p class="buttonText">Delete Walk</p>
					</button>
				</form>
			</nav>
		</div>
        {% endif %}
            
        </div>


		
    </div>

  </div><!-- /.row -->
    
    <div class="row">
    <div class="col-md-8">
        
        <h3>Comments on this walk</h3>
    <div id="commentScrollbox">
    <div class="card mb-6">
        <div class="card-body">
                {% if comments %}
                    <ul class="list-group">
                    {% for comment in comments %}
                        <li class="list-group-item">
                            <h5>{{comment.title}}</h5> <br />
                            <em>{{comment.comment}}</em> <br />
                            by <a href="{%url 'rate_my_walk:profile' username=comment.owner %}">{{comment.owner}}</a> <br />
					{{comment.date}}
                        </li>
                    {% endfor %}
      
                    </ul>
                {% else %}
                    <strong>No comments on this walk yet.</strong>
                {% endif %}
            </div>
        </div>
    </div>
    
    <br />
    <br />
    <br />
    <div><!-- search bar -->
        
    <h3>Use this to search for the walk using Bing!</h3>
	<form
		class="form-inline"
		id="user-form"
		method ="post"
		action="{% url 'rate_my_walk:showWalk' walk.slug %}"
	>
		{% csrf_token %}
		
		<div class="form-group">
			<input
				type="text"
				size="50"
				name="query"
				id="query"
				value="{{last_query}}">
		
		</div>
		
        <button class="py-1 mb-2 bg-dark rounded btn" type="submit" name="submit">
            <p class="buttonText">Search</p>
        </button>			
	</form>
  </div><!-- /search bar -->

  <div><!-- search results -->
	{% if result_list %}
		<h2>Results</h2>
		
		<div class="list-group">
		
			{% for result in result_list %}
				<div class="list-group-item">
					<h3 class="list-group-item-heading">
						<a href="{{ result.link }}">
							{{ result.title|safe|escape }}
						</a>
					</h3>
					<p class="list-group-item-text">
						{{ result.summary|safe|escape }}
					</p>
				</div>
			{% endfor %}
		</div>
			
	{% endif %}
	
  </div><!-- /search results -->

    </div>

    <div class="col-md-4">
        <div><!-- add new comment -->
            <h3>Add your own comment</h3>
            {% if user.is_authenticated %}
                <form id="comment_form" method="post" action="{% url 'rate_my_walk:showWalk' walk.slug %}", enctype="multipart/form-data">
                {% csrf_token %}
                {% for hidden in comment_form.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
                {% for field in comment_form.visible_fields %}
                    {{ field.errors }}
                    {{ field.help_text }}<br />
                    {{ field }}<br />
                {% endfor %}
                    <br />
                    <button class="py-1 mb-2 bg-dark rounded btn" type="submit" name="submit">
                        <p class="buttonText">Upload Comment</p>
                    </button>
                    <div class="p-5"></div>
                 </form>
            {% else %}
                <strong>You must be logged in to leave a comment.</strong>
            {% endif %}

        </div><!-- /add new comment -->
        
        <div><!-- add new photo for more images -->
        <div>
		<h3>Add your photo</h3>
            {% if user.is_authenticated %}
                <form id="photo_form" method="post" action="{% url 'rate_my_walk:showWalk' walk.slug %}", enctype="multipart/form-data">
                {% csrf_token %}
                {% for hidden in photo_form.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
                {% for field in photo_form.visible_fields %}
                    {{ field.errors }}
                    {{ field.help_text }}<br />
                    {{ field }}<br />
                {% endfor %}
                    <br />
                    <button class="py-1 mb-2 bg-dark rounded btn" type="submit" name="submit">
                        <p class="buttonText">Upload Picture</p>
                    </button>
                    <div class="p-5"></div>
            </form>
            {% else %}
                <strong>You must be logged in to upload an image.</strong>
            {% endif %}
            </div>
        </div><!-- /add new photo for more images -->
		
    </div>

  </div>

</main><!-- /.container -->

{% endblock %}